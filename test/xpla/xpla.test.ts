import { BlockchainClient, BlockchainClientOptions, MnemonicSigner, RawKeySigner } from "../../src/index";
import { use, expect } from "chai";
import {
  ECDClient,
  EvmAddress,
  EvmMsg, EvmSendNft,
  EvmTx,
  LCDClient,
  MnemonicKey,
  MsgSend,
  Numeric
} from "@xpla/xpla.js";
import { TxStatus } from "../../src/type";
import { XplaCreateTxData, XplaFeeConfig } from "../../src/client/xpla/XplaType";
import { Balance } from "../../src/type/Balance";
import Web3 from "web3";

use(require("chai-as-promised"));

describe('Xpla Client', () => {
  let xpla: BlockchainClient;

  before(() => {
    xpla = new BlockchainClient({
      type: 'xpla',
      nodeURL: 'https://cube-lcd.xpla.dev',
      chainID: 'cube_47-5'
    } as BlockchainClientOptions);
  });

  describe('Account', () => {
    let emptyAddress: string;
    let invalidAddress: string;

    before(() => {
      emptyAddress = xpla.client.createAccount().address;
      invalidAddress = 'xplainvalidaddress';
    });

    describe('getBalance', () => {
      it('Should be returned the balance of empty account as zero', async function () {
        await expect(xpla.client.getBalance(emptyAddress)).to.eventually.deep.equal({ value: BigInt(0), decimals: 18 } as Balance);
      });
      it('Should throw an error if an invalid address received', async function () {
        await expect(xpla.client.getBalance(invalidAddress)).to.be.rejected;
      });
    });

    describe('getAccountState', () => {
      it('Should throw an error if an empty address received', async function () {
        await expect(xpla.client.getAccountState(emptyAddress)).to.be.rejected;
      });
      it('Should throw an error if an invalid address received', async function () {
        await expect(xpla.client.getAccountState(invalidAddress)).to.be.rejected;
      });
    });
  });

  describe('Chain data', () => {
    let blockNumber: number;
    let txhash: string;

    before(() => {
      blockNumber = 2578385;
      txhash = '25796C55BF78A34DB480C670CEEC17ED335D7E6F2A061D0D36B514F763C67611';
    });

    describe('getBlock', () => {
      it('Should get a block of the correct number', async function () {
        await expect(xpla.client.getBlock(blockNumber)).to.eventually
          .have.all.keys('number', 'hash', 'miner', 'txs', 'timestamp')
          .and.have.property('number', blockNumber);
      });
    });
    describe('getTx', () => {
      it('Should get a transaction of the correct tx hash', async function () {
        const tx = await xpla.client.getTx(txhash);
        expect(tx).to.have.all.keys('txhash', 'blockNumber', 'status', 'fee', 'data', 'logs');
        expect(tx).to.have.property('txhash', txhash);
        expect(tx).to.have.property('blockNumber', blockNumber);
        expect(tx).to.have.property('status', <TxStatus>"success");
      });
    });
  });

  describe('Transaction', () => {
    let fromMnemonic: string;
    let fromPrivateKey: string;
    let createTxOptions: XplaCreateTxData;

    before(() => {
      fromMnemonic = 'section task latin write whip rain magic basic hunt junior random noble test fruit health bottom pole melody wild bacon mom trash reopen stomach';
      fromPrivateKey = 'DNJ+3EWC19SZBmdrWvRri8BfrWteqxEDSjwf8ySIUGo=';
      let to = 'xpla1n88cvfxxhgzkalkqzsdd5qaeslxhlsux60mrww';
      let amount = '1000000000000000000';
      let memo = '1234';
      let from = xpla.client.createAccount(fromMnemonic).address;
      createTxOptions = {
        signers: [{ address: from }],
        msgs: [
          new MsgSend(from, to, { axpla: amount })
        ],
        memo: memo
      };
    });

    describe('createTx', () => {
      let expectedUnsignedTx: string;
      before(() => {
        expectedUnsignedTx = 'CpgBCo8BChwvY29zbW9zLmJhbmsudjFiZXRhMS5Nc2dTZW5kEm8KK3hwbGExNWpqbGswMmdnOW15NmU0amR3emw0cHJxMzZqanNxengyZTV4djASK3hwbGExbjg4Y3ZmeHhoZ3prYWxrcXpzZGQ1cWFlc2x4aGxzdXg2MG1yd3caEwoFYXhwbGESCjEwMDAwMDAwMDASBDEyMzQSIxIhChsKBWF4cGxhEhIxNDM3ODMyMzc1MDAwMDAwMDAQxKkK';
      });
      it('test', async () => {
        console.log(await xpla.client.createTx(createTxOptions, false))
      })

      it('Should return the expected correct tx', async function () {
        const unsignedTx = await xpla.client.createTx(createTxOptions, true);
        console.log(unsignedTx)
        expect(unsignedTx).to.be.equal(expectedUnsignedTx);
      });

      it('Should ensure that the input values are the same as the result of decoding', async function () {
        const unsignedTx = await xpla.client.createTx(createTxOptions, true)
        const decodedTx = (<LCDClient>xpla.client.getProvider()).tx.decode(unsignedTx);
        expect(decodedTx.body.memo).to.be.equal(createTxOptions.memo);
        expect(decodedTx.body.messages).to.be.deep.equal(createTxOptions.msgs);
      });

      it('Should ensure that the fee values are the same as the result of createTx', async function () {
        const [unsignedTx, estimateFee] = await Promise.all([
          xpla.client.createTx({ ...createTxOptions, gasAdjustment: 1.5 }, true),
          xpla.client.estimateFee(createTxOptions)
        ]);
        const feeInTx = (<LCDClient>xpla.client.getProvider()).tx.decode(unsignedTx).auth_info.fee.toData();
        expect(feeInTx.gas_limit).to.be.equal((<XplaFeeConfig>estimateFee).fee.gas_limit);
      });
    });

    describe('signTx', () => {
      it('Should have the correct signature', async function () {
        const tx = await xpla.client.createTx(createTxOptions, true);
        const signedTx = await xpla.client.signTx(tx, new MnemonicSigner(fromMnemonic));
        const signedTx2 = await xpla.client.signTx(tx, new RawKeySigner(fromPrivateKey));
        console.log(signedTx);
        console.log(signedTx2)

        // const result = await xpla.client.sendSignedTx(signedTx);
        // console.log(result)
      }).timeout(50000);

      it('Should be able to create and sign tx with a specified sequence number', async function () {
        const customSequenceNumber = 1100;
        const customTxOptions = { ...createTxOptions };
        customTxOptions.signers[0] = { ...customTxOptions.signers[0], sequenceNumber: customSequenceNumber };
        const tx = await xpla.client.createTx(customTxOptions, true);
        const signedTx = await xpla.client.signTx(tx, new MnemonicSigner(fromMnemonic));
        const decodedTx = (<LCDClient>xpla.client.getProvider()).tx.decode(signedTx);
        expect(decodedTx.auth_info.signer_infos[0].sequence).to.be.equal(customSequenceNumber);

        console.log(xpla.client.createAccount("raccoon radio claw private install hat divert identify divert agree harsh balcony make cloud movie seminar impact interest roof arena toast march trouble expire").privateKey)
      })
    });

    describe('signMsg', () => {
      it('Should have the correct msg signature', async function () {
        const message = 'message';
        const signedMsg = await xpla.client.signMsg(message, new MnemonicSigner(fromMnemonic));
        const signedMsg2 = await new MnemonicKey({mnemonic: fromMnemonic}).sign(Buffer.from(new TextEncoder().encode(message)));

        expect(signedMsg).to.be.equal(Buffer.from(signedMsg2).toString('base64'));

      }).timeout(50000);

      it('test', async () => {
        // const acnt = await xpla.client.getAccountState('xpla1aj6a2z2ryvwn5w4sw3qnp0cv6pan2pvy35adr7')
        const acnt = await xpla.client.getProvider().auth.accountInfo('xpla1aj6a2z2ryvwn5w4sw3qnp0cv6pan2pvy35adr7');
        console.log(acnt);
        console.log(acnt.getPublicKey())
      })
    });
  });

  describe('Contract', () => {
    let contract: string;
    let message: any;

    before(() => {
      contract = 'xpla14hj2tavq8fpesdwxxcu44rty3hh90vhujrvcmstl4zr3txmfvw9s525s0h';
      message = { balance: { address: 'xpla12ndjjqce43j69pczveuzd0g64zufk4j7qn7fhh' } };
    });

    describe('queryContract', () => {
      it('Should work correctly', async function () {
        await expect(xpla.client.contractQuery(contract, message)).to.eventually.have.ownProperty('balance');
      })
    })
  });

  describe('EVM(Ethermint) Test', () => {
    let ecdClient: ECDClient;
    const evmAddress1 = '0xa4A5fb3D4841764D66b26b85Fa84608Ea5280046';

    before(() => {
      ecdClient = new ECDClient({
        URL: 'https://cube-evm-rpc.xpla.dev',
        chainID: 'cube_47-5',
        id: ECDClient.getIDfromChainID("cube_47-5")
      });
    });

    describe('Query ECD Client', () => {
      it('Query balance with evm address', async () => {
        const balance = await ecdClient.bank.balance(evmAddress1)
        console.log(balance);
      })

      it('Query tx', async () => {
        const txhash = '0xaadb16eb567279f70f5122d28e4d0ef8bca09af65b87ee063412e20410a38785'
        const txInfo = await ecdClient.tx.txInfo(txhash);
        console.log(txInfo);
      })
    });

    describe('NFT Test', () => {
      it('Deploy NFT', async () => {
        const key = new MnemonicKey({mnemonic: "section task latin write whip rain magic basic hunt junior random noble test fruit health bottom pole melody wild bacon mom trash reopen stomach"});

        const wallet = ecdClient.wallet(key);
        const msg = new EvmDeployNft(key.eip55Address);
        const signedTx = await wallet.createAndSignTx({msgs: [msg]});
        const txhash = await ecdClient.tx.broadcastSync(signedTx);
        console.log(txhash);
      })

      it('NFT Info', async () => {
        const nftContract = '0x370367dd645e8f8e008c61dba26b934c80d82138';
        const name = await ecdClient.nft.name(nftContract);
        const symbol = await ecdClient.nft.symbol(nftContract);
        console.log(name);
        console.log(symbol);
      })

      it('Mint NFT', async () => {
        const nftContract = '0xe3f3e85690adf9ae17cade5c12998eda4c346180';
        const key = new MnemonicKey({mnemonic: "section task latin write whip rain magic basic hunt junior random noble test fruit health bottom pole melody wild bacon mom trash reopen stomach"});
        const wallet = ecdClient.wallet(key);
        // const msg = new EvmMintNft(nftContract, key.eip55Address, key.eip55Address, '1', 'ipfs://QmaN1jRPtmzeqhp6s3mR1SRK4q1xWPvFvwqW1jyN6trir9/1')
        const msg = new EvmERC5679MintNft(nftContract, key.eip55Address, key.eip55Address, '1', 'ipfs://QmaN1jRPtmzeqhp6s3mR1SRK4q1xWPvFvwqW1jyN6trir9/1')
        const signedTx = await wallet.createAndSignTx({msgs: [msg]});
        const txhash = await ecdClient.tx.broadcastSync(signedTx);
        console.log(txhash);
      })

      it('Transfer NFT', async () => {
        const nftContract = '0x85af130e656b78621a3d2fe6b2928e94f2fbfe13';
        const key = new MnemonicKey({mnemonic: "section task latin write whip rain magic basic hunt junior random noble test fruit health bottom pole melody wild bacon mom trash reopen stomach"});
        const wallet = ecdClient.wallet(key);
        const msg = new EvmSendNft(nftContract, key.eip55Address, '0x9414Ed13228b58Cb7D562914b9458eEcF6a3f251', '1')
        const signedTx = await wallet.createAndSignTx({msgs: [msg]});
        const txhash = await ecdClient.tx.broadcastSync(signedTx);
        console.log(txhash);
      })
    });
  })
});

class EvmDeployNft extends EvmMsg {
  constructor(
    public from: EvmAddress,
  ) {
    super();
  }

  public tx(): EvmTx {
    const tx: EvmTx = {};
    tx.type = 0;
    tx.from = this.from;
    tx.value = Numeric.parse(0);
    tx.data = Buffer.from(
      '60806040523480156200001157600080fd5b506040516200441b3803806200441b83398181016040528101906200003791906200035d565b8282620000596200004d6200009960201b60201c565b620000a160201b60201c565b81600190816200006a919062000642565b5080600290816200007c919062000642565b5050506200009081620000a160201b60201c565b50505062000729565b600033905090565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050816000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b620001ce8262000183565b810181811067ffffffffffffffff82111715620001f057620001ef62000194565b5b80604052505050565b60006200020562000165565b9050620002138282620001c3565b919050565b600067ffffffffffffffff82111562000236576200023562000194565b5b620002418262000183565b9050602081019050919050565b60005b838110156200026e57808201518184015260208101905062000251565b60008484015250505050565b6000620002916200028b8462000218565b620001f9565b905082815260208101848484011115620002b057620002af6200017e565b5b620002bd8482856200024e565b509392505050565b600082601f830112620002dd57620002dc62000179565b5b8151620002ef8482602086016200027a565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006200032582620002f8565b9050919050565b620003378162000318565b81146200034357600080fd5b50565b60008151905062000357816200032c565b92915050565b6000806000606084860312156200037957620003786200016f565b5b600084015167ffffffffffffffff8111156200039a576200039962000174565b5b620003a886828701620002c5565b935050602084015167ffffffffffffffff811115620003cc57620003cb62000174565b5b620003da86828701620002c5565b9250506040620003ed8682870162000346565b9150509250925092565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200044a57607f821691505b60208210810362000460576200045f62000402565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302620004ca7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826200048b565b620004d686836200048b565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b6000620005236200051d6200051784620004ee565b620004f8565b620004ee565b9050919050565b6000819050919050565b6200053f8362000502565b620005576200054e826200052a565b84845462000498565b825550505050565b600090565b6200056e6200055f565b6200057b81848462000534565b505050565b5b81811015620005a3576200059760008262000564565b60018101905062000581565b5050565b601f821115620005f257620005bc8162000466565b620005c7846200047b565b81016020851015620005d7578190505b620005ef620005e6856200047b565b83018262000580565b50505b505050565b600082821c905092915050565b60006200061760001984600802620005f7565b1980831691505092915050565b600062000632838362000604565b9150826002028217905092915050565b6200064d82620003f7565b67ffffffffffffffff81111562000669576200066862000194565b5b62000675825462000431565b62000682828285620005a7565b600060209050601f831160018114620006ba5760008415620006a5578287015190505b620006b1858262000624565b86555062000721565b601f198416620006ca8662000466565b60005b82811015620006f457848901518255600182019150602085019450602081019050620006cd565b8683101562000714578489015162000710601f89168262000604565b8355505b6001600288020188555050505b505050505050565b613ce280620007396000396000f3fe608060405234801561001057600080fd5b50600436106101425760003560e01c806370a08231116100b857806395d89b411161007c57806395d89b4114610373578063a22cb46514610391578063b88d4fde146103ad578063c87b56dd146103c9578063e985e9c5146103f9578063f2fde38b1461042957610142565b806370a08231146102e3578063715018a6146103135780638832e6e31461031d5780638da5cb5b1461033957806394d008ef1461035757610142565b806323b872dd1161010a57806323b872dd146101ff5780632f745c591461021b57806342842e0e1461024b57806344d17187146102675780634f6ccce7146102835780636352211e146102b357610142565b806301ffc9a71461014757806306fdde0314610177578063081812fc14610195578063095ea7b3146101c557806318160ddd146101e1575b600080fd5b610161600480360381019061015c9190612787565b610445565b60405161016e91906127cf565b60405180910390f35b61017f6104bf565b60405161018c919061287a565b60405180910390f35b6101af60048036038101906101aa91906128d2565b610551565b6040516101bc9190612940565b60405180910390f35b6101df60048036038101906101da9190612987565b610597565b005b6101e96106ae565b6040516101f691906129d6565b60405180910390f35b610219600480360381019061021491906129f1565b6106bb565b005b61023560048036038101906102309190612987565b61071b565b60405161024291906129d6565b60405180910390f35b610265600480360381019061026091906129f1565b6107c0565b005b610281600480360381019061027c9190612aa9565b6107e0565b005b61029d600480360381019061029891906128d2565b610937565b6040516102aa91906129d6565b60405180910390f35b6102cd60048036038101906102c891906128d2565b6109a8565b6040516102da9190612940565b60405180910390f35b6102fd60048036038101906102f89190612b1d565b610a2e565b60405161030a91906129d6565b60405180910390f35b61031b610ae5565b005b61033760048036038101906103329190612aa9565b610af9565b005b610341610ba4565b60405161034e9190612940565b60405180910390f35b610371600480360381019061036c9190612aa9565b610bcd565b005b61037b610c33565b604051610388919061287a565b60405180910390f35b6103ab60048036038101906103a69190612b76565b610cc5565b005b6103c760048036038101906103c29190612ce6565b610cdb565b005b6103e360048036038101906103de91906128d2565b610d3d565b6040516103f0919061287a565b60405180910390f35b610413600480360381019061040e9190612d69565b610d4f565b60405161042091906127cf565b60405180910390f35b610443600480360381019061043e9190612b1d565b610de3565b005b60007fcce39764000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614806104b857506104b782610e66565b5b9050919050565b6060600180546104ce90612dd8565b80601f01602080910402602001604051908101604052809291908181526020018280546104fa90612dd8565b80156105475780601f1061051c57610100808354040283529160200191610547565b820191906000526020600020905b81548152906001019060200180831161052a57829003601f168201915b5050505050905090565b600061055c82610ee0565b6005600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b60006105a2826109a8565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610612576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161060990612e7b565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff16610631610f2b565b73ffffffffffffffffffffffffffffffffffffffff161480610660575061065f8161065a610f2b565b610d4f565b5b61069f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161069690612f0d565b60405180910390fd5b6106a98383610f33565b505050565b6000600a80549050905090565b6106cc6106c6610f2b565b82610fec565b61070b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161070290612f9f565b60405180910390fd5b610716838383611081565b505050565b600061072683610a2e565b8210610767576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161075e90613031565b60405180910390fd5b600860008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600083815260200190815260200160002054905092915050565b6107db83838360405180602001604052806000815250610cdb565b505050565b6107e9836109a8565b73ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1614610856576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161084d9061309d565b60405180910390fd5b8373ffffffffffffffffffffffffffffffffffffffff16610875610f2b565b73ffffffffffffffffffffffffffffffffffffffff1614806108a457506108a38461089e610f2b565b610d4f565b5b806108e957506108b2610f2b565b73ffffffffffffffffffffffffffffffffffffffff166108d184610551565b73ffffffffffffffffffffffffffffffffffffffff16145b610928576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161091f9061312f565b60405180910390fd5b6109318361137a565b50505050565b60006109416106ae565b8210610982576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610979906131c1565b60405180910390fd5b600a8281548110610996576109956131e1565b5b90600052602060002001549050919050565b6000806109b483611386565b9050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610a25576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a1c9061325c565b60405180910390fd5b80915050919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610a9e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a95906132ee565b60405180910390fd5b600460008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b610aed6113c3565b610af76000611441565b565b610b016113c3565b610b50848484848080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050611505565b610b9e8383838080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050611560565b50505050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b610bd56113c3565b610bdf84846115cd565b610c2d8383838080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050611560565b50505050565b606060028054610c4290612dd8565b80601f0160208091040260200160405190810160405280929190818152602001828054610c6e90612dd8565b8015610cbb5780601f10610c9057610100808354040283529160200191610cbb565b820191906000526020600020905b815481529060010190602001808311610c9e57829003601f168201915b5050505050905090565b610cd7610cd0610f2b565b83836117ea565b5050565b610cec610ce6610f2b565b83610fec565b610d2b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d2290612f9f565b60405180910390fd5b610d3784848484611956565b50505050565b6060610d48826119b2565b9050919050565b6000600660008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610deb6113c3565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610e5a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e5190613380565b60405180910390fd5b610e6381611441565b50565b60007f780e9d63000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161480610ed95750610ed882611ac4565b5b9050919050565b610ee981611ba6565b610f28576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f1f9061325c565b60405180910390fd5b50565b600033905090565b816005600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610fa6836109a8565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b600080610ff8836109a8565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16148061103a57506110398185610d4f565b5b8061107857508373ffffffffffffffffffffffffffffffffffffffff1661106084610551565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff166110a1826109a8565b73ffffffffffffffffffffffffffffffffffffffff16146110f7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016110ee90613412565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603611166576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161115d906134a4565b60405180910390fd5b6111738383836001611be7565b8273ffffffffffffffffffffffffffffffffffffffff16611193826109a8565b73ffffffffffffffffffffffffffffffffffffffff16146111e9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111e090613412565b60405180910390fd5b6005600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600460008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506001600460008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816003600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46113758383836001611bf9565b505050565b61138381611bff565b50565b60006003600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b6113cb610f2b565b73ffffffffffffffffffffffffffffffffffffffff166113e9610ba4565b73ffffffffffffffffffffffffffffffffffffffff161461143f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161143690613510565b60405180910390fd5b565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050816000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b61150f83836115cd565b61151c6000848484611c52565b61155b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611552906135a2565b60405180910390fd5b505050565b61156982611ba6565b6115a8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161159f90613634565b60405180910390fd5b806007600084815260200190815260200160002090816115c89190613800565b505050565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361163c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016116339061391e565b60405180910390fd5b61164581611ba6565b15611685576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161167c9061398a565b60405180910390fd5b611693600083836001611be7565b61169c81611ba6565b156116dc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016116d39061398a565b60405180910390fd5b6001600460008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816003600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46117e6600083836001611bf9565b5050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603611858576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161184f906139f6565b60405180910390fd5b80600660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c318360405161194991906127cf565b60405180910390a3505050565b611961848484611081565b61196d84848484611c52565b6119ac576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016119a3906135a2565b60405180910390fd5b50505050565b60606119bd82610ee0565b60006007600084815260200190815260200160002080546119dd90612dd8565b80601f0160208091040260200160405190810160405280929190818152602001828054611a0990612dd8565b8015611a565780601f10611a2b57610100808354040283529160200191611a56565b820191906000526020600020905b815481529060010190602001808311611a3957829003601f168201915b505050505090506000611a67611dd9565b90506000815103611a7c578192505050611abf565b600082511115611ab1578082604051602001611a99929190613a52565b60405160208183030381529060405292505050611abf565b611aba84611df0565b925050505b919050565b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161480611b8f57507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b80611b9f5750611b9e82611e58565b5b9050919050565b60008073ffffffffffffffffffffffffffffffffffffffff16611bc883611386565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b611bf384848484611ec2565b50505050565b50505050565b611c0881612020565b6000600760008381526020019081526020016000208054611c2890612dd8565b905014611c4f57600760008281526020019081526020016000206000611c4e91906126be565b5b50565b6000611c738473ffffffffffffffffffffffffffffffffffffffff1661216e565b15611dcc578373ffffffffffffffffffffffffffffffffffffffff1663150b7a02611c9c610f2b565b8786866040518563ffffffff1660e01b8152600401611cbe9493929190613acb565b6020604051808303816000875af1925050508015611cfa57506040513d601f19601f82011682018060405250810190611cf79190613b2c565b60015b611d7c573d8060008114611d2a576040519150601f19603f3d011682016040523d82523d6000602084013e611d2f565b606091505b506000815103611d74576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611d6b906135a2565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614915050611dd1565b600190505b949350505050565b606060405180602001604052806000815250905090565b6060611dfb82610ee0565b6000611e05611dd9565b90506000815111611e255760405180602001604052806000815250611e50565b80611e2f84612191565b604051602001611e40929190613a52565b6040516020818303038152906040525b915050919050565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b611ece8484848461225f565b6001811115611f12576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611f0990613bcb565b60405180910390fd5b6000829050600073ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff1603611f5957611f5481612265565b611f98565b8373ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff1614611f9757611f9685826122ae565b5b5b600073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1603611fda57611fd58161241b565b612019565b8473ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff16146120185761201784826124ec565b5b5b5050505050565b600061202b826109a8565b905061203b816000846001611be7565b612044826109a8565b90506005600083815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600460008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506003600083815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905581600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a461216a816000846001611bf9565b5050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b6060600060016121a08461256b565b01905060008167ffffffffffffffff8111156121bf576121be612bbb565b5b6040519080825280601f01601f1916602001820160405280156121f15781602001600182028036833780820191505090505b509050600082602001820190505b600115612254578080600190039150507f3031323334353637383961626364656600000000000000000000000000000000600a86061a8153600a858161224857612247613beb565b5b049450600085036121ff575b819350505050919050565b50505050565b600a80549050600b600083815260200190815260200160002081905550600a81908060018154018082558091505060019003906000526020600020016000909190919091505550565b600060016122bb84610a2e565b6122c59190613c49565b90506000600960008481526020019081526020016000205490508181146123aa576000600860008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600084815260200190815260200160002054905080600860008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600084815260200190815260200160002081905550816009600083815260200190815260200160002081905550505b6009600084815260200190815260200160002060009055600860008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008381526020019081526020016000206000905550505050565b60006001600a8054905061242f9190613c49565b90506000600b60008481526020019081526020016000205490506000600a838154811061245f5761245e6131e1565b5b9060005260206000200154905080600a8381548110612481576124806131e1565b5b906000526020600020018190555081600b600083815260200190815260200160002081905550600b600085815260200190815260200160002060009055600a8054806124d0576124cf613c7d565b5b6001900381819060005260206000200160009055905550505050565b60006124f783610a2e565b905081600860008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600083815260200190815260200160002081905550806009600084815260200190815260200160002081905550505050565b600080600090507a184f03e93ff9f4daa797ed6e38ed64bf6a1f01000000000000000083106125c9577a184f03e93ff9f4daa797ed6e38ed64bf6a1f01000000000000000083816125bf576125be613beb565b5b0492506040810190505b6d04ee2d6d415b85acef81000000008310612606576d04ee2d6d415b85acef810000000083816125fc576125fb613beb565b5b0492506020810190505b662386f26fc10000831061263557662386f26fc10000838161262b5761262a613beb565b5b0492506010810190505b6305f5e100831061265e576305f5e100838161265457612653613beb565b5b0492506008810190505b612710831061268357612710838161267957612678613beb565b5b0492506004810190505b606483106126a6576064838161269c5761269b613beb565b5b0492506002810190505b600a83106126b5576001810190505b80915050919050565b5080546126ca90612dd8565b6000825580601f106126dc57506126fb565b601f0160209004906000526020600020908101906126fa91906126fe565b5b50565b5b808211156127175760008160009055506001016126ff565b5090565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b6127648161272f565b811461276f57600080fd5b50565b6000813590506127818161275b565b92915050565b60006020828403121561279d5761279c612725565b5b60006127ab84828501612772565b91505092915050565b60008115159050919050565b6127c9816127b4565b82525050565b60006020820190506127e460008301846127c0565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015612824578082015181840152602081019050612809565b60008484015250505050565b6000601f19601f8301169050919050565b600061284c826127ea565b61285681856127f5565b9350612866818560208601612806565b61286f81612830565b840191505092915050565b600060208201905081810360008301526128948184612841565b905092915050565b6000819050919050565b6128af8161289c565b81146128ba57600080fd5b50565b6000813590506128cc816128a6565b92915050565b6000602082840312156128e8576128e7612725565b5b60006128f6848285016128bd565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061292a826128ff565b9050919050565b61293a8161291f565b82525050565b60006020820190506129556000830184612931565b92915050565b6129648161291f565b811461296f57600080fd5b50565b6000813590506129818161295b565b92915050565b6000806040838503121561299e5761299d612725565b5b60006129ac85828601612972565b92505060206129bd858286016128bd565b9150509250929050565b6129d08161289c565b82525050565b60006020820190506129eb60008301846129c7565b92915050565b600080600060608486031215612a0a57612a09612725565b5b6000612a1886828701612972565b9350506020612a2986828701612972565b9250506040612a3a868287016128bd565b9150509250925092565b600080fd5b600080fd5b600080fd5b60008083601f840112612a6957612a68612a44565b5b8235905067ffffffffffffffff811115612a8657612a85612a49565b5b602083019150836001820283011115612aa257612aa1612a4e565b5b9250929050565b60008060008060608587031215612ac357612ac2612725565b5b6000612ad187828801612972565b9450506020612ae2878288016128bd565b935050604085013567ffffffffffffffff811115612b0357612b0261272a565b5b612b0f87828801612a53565b925092505092959194509250565b600060208284031215612b3357612b32612725565b5b6000612b4184828501612972565b91505092915050565b612b53816127b4565b8114612b5e57600080fd5b50565b600081359050612b7081612b4a565b92915050565b60008060408385031215612b8d57612b8c612725565b5b6000612b9b85828601612972565b9250506020612bac85828601612b61565b9150509250929050565b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b612bf382612830565b810181811067ffffffffffffffff82111715612c1257612c11612bbb565b5b80604052505050565b6000612c2561271b565b9050612c318282612bea565b919050565b600067ffffffffffffffff821115612c5157612c50612bbb565b5b612c5a82612830565b9050602081019050919050565b82818337600083830152505050565b6000612c89612c8484612c36565b612c1b565b905082815260208101848484011115612ca557612ca4612bb6565b5b612cb0848285612c67565b509392505050565b600082601f830112612ccd57612ccc612a44565b5b8135612cdd848260208601612c76565b91505092915050565b60008060008060808587031215612d0057612cff612725565b5b6000612d0e87828801612972565b9450506020612d1f87828801612972565b9350506040612d30878288016128bd565b925050606085013567ffffffffffffffff811115612d5157612d5061272a565b5b612d5d87828801612cb8565b91505092959194509250565b60008060408385031215612d8057612d7f612725565b5b6000612d8e85828601612972565b9250506020612d9f85828601612972565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680612df057607f821691505b602082108103612e0357612e02612da9565b5b50919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b6000612e656021836127f5565b9150612e7082612e09565b604082019050919050565b60006020820190508181036000830152612e9481612e58565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60008201527f6b656e206f776e6572206f7220617070726f76656420666f7220616c6c000000602082015250565b6000612ef7603d836127f5565b9150612f0282612e9b565b604082019050919050565b60006020820190508181036000830152612f2681612eea565b9050919050565b7f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560008201527f72206f7220617070726f76656400000000000000000000000000000000000000602082015250565b6000612f89602d836127f5565b9150612f9482612f2d565b604082019050919050565b60006020820190508181036000830152612fb881612f7c565b9050919050565b7f455243373231456e756d657261626c653a206f776e657220696e646578206f7560008201527f74206f6620626f756e6473000000000000000000000000000000000000000000602082015250565b600061301b602b836127f5565b915061302682612fbf565b604082019050919050565b6000602082019050818103600083015261304a8161300e565b9050919050565b7f46726f6d2061646472657373206973206e6f7420746f6b656e206f776e657200600082015250565b6000613087601f836127f5565b915061309282613051565b602082019050919050565b600060208201905081810360008301526130b68161307a565b9050919050565b7f43616c6c6572206973206e6f7420746f6b656e206f776e6572206f722061707060008201527f726f766564000000000000000000000000000000000000000000000000000000602082015250565b60006131196025836127f5565b9150613124826130bd565b604082019050919050565b600060208201905081810360008301526131488161310c565b9050919050565b7f455243373231456e756d657261626c653a20676c6f62616c20696e646578206f60008201527f7574206f6620626f756e64730000000000000000000000000000000000000000602082015250565b60006131ab602c836127f5565b91506131b68261314f565b604082019050919050565b600060208201905081810360008301526131da8161319e565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b7f4552433732313a20696e76616c696420746f6b656e2049440000000000000000600082015250565b60006132466018836127f5565b915061325182613210565b602082019050919050565b6000602082019050818103600083015261327581613239565b9050919050565b7f4552433732313a2061646472657373207a65726f206973206e6f74206120766160008201527f6c6964206f776e65720000000000000000000000000000000000000000000000602082015250565b60006132d86029836127f5565b91506132e38261327c565b604082019050919050565b60006020820190508181036000830152613307816132cb565b9050919050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b600061336a6026836127f5565b91506133758261330e565b604082019050919050565b600060208201905081810360008301526133998161335d565b9050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b60006133fc6025836127f5565b9150613407826133a0565b604082019050919050565b6000602082019050818103600083015261342b816133ef565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b600061348e6024836127f5565b915061349982613432565b604082019050919050565b600060208201905081810360008301526134bd81613481565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006134fa6020836127f5565b9150613505826134c4565b602082019050919050565b60006020820190508181036000830152613529816134ed565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b600061358c6032836127f5565b915061359782613530565b604082019050919050565b600060208201905081810360008301526135bb8161357f565b9050919050565b7f45524337323155524953746f726167653a2055524920736574206f66206e6f6e60008201527f6578697374656e7420746f6b656e000000000000000000000000000000000000602082015250565b600061361e602e836127f5565b9150613629826135c2565b604082019050919050565b6000602082019050818103600083015261364d81613611565b9050919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026136b67fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82613679565b6136c08683613679565b95508019841693508086168417925050509392505050565b6000819050919050565b60006136fd6136f86136f38461289c565b6136d8565b61289c565b9050919050565b6000819050919050565b613717836136e2565b61372b61372382613704565b848454613686565b825550505050565b600090565b613740613733565b61374b81848461370e565b505050565b5b8181101561376f57613764600082613738565b600181019050613751565b5050565b601f8211156137b45761378581613654565b61378e84613669565b8101602085101561379d578190505b6137b16137a985613669565b830182613750565b50505b505050565b600082821c905092915050565b60006137d7600019846008026137b9565b1980831691505092915050565b60006137f083836137c6565b9150826002028217905092915050565b613809826127ea565b67ffffffffffffffff81111561382257613821612bbb565b5b61382c8254612dd8565b613837828285613773565b600060209050601f83116001811461386a5760008415613858578287015190505b61386285826137e4565b8655506138ca565b601f19841661387886613654565b60005b828110156138a05784890151825560018201915060208501945060208101905061387b565b868310156138bd57848901516138b9601f8916826137c6565b8355505b6001600288020188555050505b505050505050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b60006139086020836127f5565b9150613913826138d2565b602082019050919050565b60006020820190508181036000830152613937816138fb565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b6000613974601c836127f5565b915061397f8261393e565b602082019050919050565b600060208201905081810360008301526139a381613967565b9050919050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b60006139e06019836127f5565b91506139eb826139aa565b602082019050919050565b60006020820190508181036000830152613a0f816139d3565b9050919050565b600081905092915050565b6000613a2c826127ea565b613a368185613a16565b9350613a46818560208601612806565b80840191505092915050565b6000613a5e8285613a21565b9150613a6a8284613a21565b91508190509392505050565b600081519050919050565b600082825260208201905092915050565b6000613a9d82613a76565b613aa78185613a81565b9350613ab7818560208601612806565b613ac081612830565b840191505092915050565b6000608082019050613ae06000830187612931565b613aed6020830186612931565b613afa60408301856129c7565b8181036060830152613b0c8184613a92565b905095945050505050565b600081519050613b268161275b565b92915050565b600060208284031215613b4257613b41612725565b5b6000613b5084828501613b17565b91505092915050565b7f455243373231456e756d657261626c653a20636f6e736563757469766520747260008201527f616e7366657273206e6f7420737570706f727465640000000000000000000000602082015250565b6000613bb56035836127f5565b9150613bc082613b59565b604082019050919050565b60006020820190508181036000830152613be481613ba8565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000613c548261289c565b9150613c5f8361289c565b9250828203905081811115613c7757613c76613c1a565b5b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603160045260246000fdfea26469706673582212207d78031a27f59d5e436c15b56127fb3fa0f9147004c38bfe8d5422e5b75143e164736f6c63430008120033000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000a4a5fb3d4841764d66b26b85fa84608ea5280046000000000000000000000000000000000000000000000000000000000000000c53696d706c65204e4654203300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005534e465433000000000000000000000000000000000000000000000000000000', "hex"
    );
    return tx;
  }
}

class EvmERC5679MintNft extends EvmMsg {
  /**
   * @param contract erc20 token contract address
   * @param owner_address contract owner's address
   * @param to_address recipient's address
   * @param id NFT's ID
   * @param uri NFT's data URI
   */
  constructor(
    public contract: EvmAddress,
    public owner_address: EvmAddress,
    public to_address: EvmAddress,
    public id: Numeric.Input,
    public uri: string
  ) {
    super();
  }

  public tx(): EvmTx {
    const tx: EvmTx = {};
    tx.type = 0;
    tx.from = this.owner_address;
    tx.to = this.contract;
    tx.value = Numeric.parse(0);
    tx.data = Buffer.from(
      '8832e6e3' + // keccak256('safeMint(address,uint256,bytes)') to 4 bytes
      ECDClient.dataFromParams(
        ['address', 'bignumber', 'bytes'],
        [this.to_address, this.id.toString(), Web3.utils.utf8ToHex(this.uri)]
      ).toString('hex'),
      'hex'
    );
    return tx;
  }
}
